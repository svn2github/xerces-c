# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

srcdir = @srcdir@
top_srcdir = @top_srcdir@
top_builddir = @top_builddir@
prefix = @prefix@
exec_prefix = @exec_prefix@
libdir = @libdir@
mkdir_p = @mkdir_p@

ICU_PREFIX = @ICU_PREFIX@

GENRB=$(ICU_PREFIX)/bin/genrb
GENCCODE=$(ICU_PREFIX)/sbin/genccode
GENCMN=$(ICU_PREFIX)/sbin/gencmn

include $(top_srcdir)/version.incl

# Resource shortname
PKGNAME=xercesc_messages_$(INTERFACE_VER_U)

# Resource files.  Add new ones for additional locales here. Keep in sync
# with the file RESLIST and don't forget to add the .lo entry in top-level
# Makefile.am.
#
RESFILES=root.res

# list of resource bundles  - keep in sync with RESFILES
#
RESLIST=$(srcdir)/res-file-list.txt

.PHONY: all
all: $(RESFILES:.res=_res.c) xercesc_messages.c

xercesc_messages.c: $(RESLIST)
	$(GENCMN) --name $(PKGNAME) -S $(PKGNAME)_dat.c -d . $<
	@mv $(PKGNAME)_dat.c xercesc_messages.c

.PRECIOUS: %_res.c
%_res.c: $(srcdir)/%.res
	$(GENCCODE) --name $(PKGNAME) -d . $<

.PRECIOUS: %.res
%.res: $(srcdir)/%.txt
	$(GENRB) $^

# Clean
#
clean distclean:
	rm -f $(RESFILES) $(RESFILES:.res=_res.c) xercesc_messages.c
#
#
.PHONY: check
check: all

# Support for "make dist"
#
distdir:
	@srcdirstrip=`echo "$(srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	list='res-file-list.txt root.txt Makefile.in'; \
	  dist_files=`for file in $$list; do echo $$file; done | \
	  sed -e "s|^$$srcdirstrip/||;t" \
	      -e "s|^$$topsrcdirstrip/|$(top_builddir)/|;t"`; \
	case $$dist_files in \
	  */*) $(mkdir_p) `echo "$$dist_files" | \
			   sed '/\//!d;s|^|$(distdir)/|;s,/[^/]*$$,,' | \
			   sort -u` ;; \
	esac; \
	for file in $$dist_files; do \
	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
	  if test -d $$d/$$file; then \
	    dir=`echo "/$$file" | sed -e 's,/[^/]*$$,,'`; \
	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
	    fi; \
	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
	  else \
	    test -f $(distdir)/$$file \
	    || cp -p $$d/$$file $(distdir)/$$file \
	    || exit 1; \
	  fi; \
	done


# Nothing to do for these targets.
#
install: ; @:
uninstall: ; @:
